<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Wheel of Fortune Classroom Game</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f4f4;
      text-align: center;
      padding: 20px;
    }
    .tile {
      width: 40px;
      height: 50px;
      border: 2px solid #444;
      margin: 5px;
      font-size: 28px;
      display: inline-flex;
      justify-content: center;
      align-items: center;
      background: white;
    }
    .revealed {
      background-color: #a8e6cf;
      font-weight: bold;
    }
    .hidden {
      color: transparent;
    }
    .scoreboard input {
      width: 100px;
      height: 40px;
      font-size: 18px;
      margin: 5px;
      text-align: center;
    }
    canvas {
      margin-top: 20px;
      border: 4px solid #000;
      border-radius: 50%;
      display: block;
      margin-left: auto;
      margin-right: auto;
    }
    #spinResult {
      font-size: 24px;
      font-weight: bold;
      margin: 15px;
    }
    .pointer {
      width: 0; 
      height: 0; 
      border-left: 15px solid transparent;
      border-right: 15px solid transparent;
      border-bottom: 25px solid red;
      margin: auto;
    }
  </style>
</head>
<body>
  <h1>Wheel of Fortune Classroom Game</h1>

  <button onclick="togglePuzzleInput()">Edit Puzzle Phrase</button><br><br>
  <input type="password" id="puzzleMasked" style="display:none;" placeholder="Type puzzle phrase" oninput="setPuzzle(this.value)" />
  <input type="text" id="puzzleRaw" style="display:none;" />

  <div id="puzzleBoard" style="margin: 20px 0;"></div>

  <input type="text" id="guessLetter" maxlength="1" placeholder="Guess a letter"/>
  <button onclick="revealLetter()">Reveal Letter</button>
  <button onclick="solvePuzzle()">Solve Puzzle</button>

  <div class="pointer"></div>
  <canvas id="wheelCanvas" width="300" height="300"></canvas>
  <button onclick="spinWheel()">Spin</button>
  <div id="spinResult"></div>

  <div class="scoreboard">
    <div>
      <input id="roundScore1" placeholder="Team 1 Round">
      <input id="totalScore1" value="0" placeholder="Total 1">
    </div>
    <div>
      <input id="roundScore2" placeholder="Team 2 Round">
      <input id="totalScore2" value="0" placeholder="Total 2">
    </div>
    <div>
      <input id="roundScore3" placeholder="Team 3 Round">
      <input id="totalScore3" value="0" placeholder="Total 3">
    </div>
    <div>
      <input id="roundScore4" placeholder="Team 4 Round">
      <input id="totalScore4" value="0" placeholder="Total 4">
    </div>
    <div>
      <input id="roundScore5" placeholder="Team 5 Round">
      <input id="totalScore5" value="0" placeholder="Total 5">
    </div>
  </div>

  <script>
    let puzzle = "";
    let revealed = [];
    let currentSpinValue = "$0";

    function togglePuzzleInput() {
      const masked = document.getElementById("puzzleMasked");
      masked.style.display = masked.style.display === "none" ? "inline-block" : "none";
      if (masked.style.display !== "none") masked.focus();
    }

    function setPuzzle(value) {
      puzzle = value.toUpperCase();
      document.getElementById("puzzleRaw").value = puzzle;
      revealed = puzzle.split('').map(c => !/[A-Z]/.test(c));
      renderPuzzle();
    }

    function renderPuzzle() {
      const board = document.getElementById("puzzleBoard");
      board.innerHTML = "";
      puzzle.split('').forEach((c, i) => {
        const div = document.createElement('div');
        div.className = 'tile';
        if (c === ' ') {
          div.style.border = "none";
        } else if (revealed[i]) {
          div.classList.add("revealed");
          div.textContent = c;
        } else {
          div.classList.add("hidden");
          div.textContent = c;
        }
        board.appendChild(div);
      });
    }

    function revealLetter() {
      const letter = document.getElementById("guessLetter").value.toUpperCase();
      document.getElementById("guessLetter").value = "";
      if (!letter.match(/[A-Z]/)) return;

      let matches = 0;
      puzzle.split('').forEach((c, i) => {
        if (c === letter && !revealed[i]) {
          revealed[i] = true;
          matches++;
        }
      });

      const value = parseInt(currentSpinValue.replace('$','')) || 0;
      if (matches > 0) {
        const team = prompt("Which team guessed correctly? (1-5)");
        const scoreBox = document.getElementById(`roundScore${team}`);
        scoreBox.value = parseInt(scoreBox.value || 0) + matches * value;
      }

      renderPuzzle();
    }

    function solvePuzzle() {
      const guess = prompt("Enter the full puzzle:").toUpperCase();
      if (guess === puzzle) {
        revealed = puzzle.split('').map(() => true);
        renderPuzzle();
        const team = prompt("Which team solved it? (1-5)");
        const roundScore = parseInt(document.getElementById(`roundScore${team}`).value || 0);
        const totalBox = document.getElementById(`totalScore${team}`);
        totalBox.value = parseInt(totalBox.value || 0) + roundScore;
        alert("Correct!");
      } else {
        alert("Incorrect.");
      }
    }

    const wedges = [
      "$500", "$700", "$600", "$900", "$800", "$5000",
      "$600", "$500", "$700", "$800", "$900", "$500",
      "$600", "$700", "Bankrupt", "Lose a Turn"
    ];

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    let finalWedges = [...wedges];
    shuffle(finalWedges);

    // Force "Bankrupt" and "Lose a Turn" to opposite sides
    const bIndex = finalWedges.indexOf("Bankrupt");
    const lIndex = (bIndex + finalWedges.length / 2) % finalWedges.length;
    finalWedges.splice(finalWedges.indexOf("Lose a Turn"), 1);
    finalWedges.splice(lIndex, 0, "Lose a Turn");

    let angle = 0, spinning = false;

    function drawWheel() {
      const canvas = document.getElementById("wheelCanvas");
      const ctx = canvas.getContext("2d");
      const center = canvas.width / 2;
      const radius = center;
      const step = 2 * Math.PI / finalWedges.length;

      ctx.clearRect(0, 0, canvas.width, canvas.height);
      ctx.save();
      ctx.translate(center, center);
      ctx.rotate(angle);

      for (let i = 0; i < finalWedges.length; i++) {
        const start = i * step;
        const end = start + step;
        ctx.beginPath();
        ctx.moveTo(0,0);
        ctx.arc(0, 0, radius, start, end);
        ctx.closePath();
        ctx.fillStyle = finalWedges[i] === "Bankrupt" ? "black" : finalWedges[i] === "Lose a Turn" ? "white" : `hsl(${Math.random()*360}, 70%, 60%)`;
        ctx.fill();
        ctx.stroke();

        ctx.save();
        ctx.rotate(start + step / 2);
        ctx.textAlign = "right";
        ctx.fillStyle = finalWedges[i] === "Lose a Turn" ? "#000" : "#fff";
        ctx.font = "bold 14px Arial";
        ctx.fillText(finalWedges[i], radius - 10, 5);
        ctx.restore();
      }

      ctx.restore();
    }

    function spinWheel() {
      if (spinning) return;
      spinning = true;
      const duration = 3000;
      const start = angle;
      const end = angle + 10 * Math.PI + Math.random() * 2 * Math.PI;
      const startTime = performance.now();

      function animate(time) {
        const progress = Math.min((time - startTime) / duration, 1);
        angle = start + (end - start) * (1 - Math.pow(1 - progress, 3));
        drawWheel();

        if (progress < 1) {
          requestAnimationFrame(animate);
        } else {
          angle %= 2 * Math.PI;
          const step = 2 * Math.PI / finalWedges.length;
          const index = (finalWedges.length - Math.floor(angle / step)) % finalWedges.length;
          currentSpinValue = finalWedges[index];
          document.getElementById("spinResult").textContent = "You spun: " + currentSpinValue;
          spinning = false;
        }
      }

      requestAnimationFrame(animate);
    }

    drawWheel();
  </script>
</body>
</html>


